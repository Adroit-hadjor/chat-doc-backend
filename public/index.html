<!DOCTYPE html>
<html>
  <body>
    <h2>Chat with My Docs</h2>

    <!-- Pick a file -->
    <input id="file" type="file" accept=".pdf,.docx,.txt,.md" />
    <button onclick="upload()">Upload</button>

    <hr/>

    <textarea id="q" placeholder="Ask a question..." style="width: 100%; height: 120px;"></textarea><br/>
    <button onclick="ask()">Ask</button>

    <p id="a"></p>

    <script>
      // If frontend and backend are separate, set window.API_BASE to your backend URL
      const API_BASE = window.API_BASE || "";

      async function upload() {
        const f = document.getElementById("file").files[0];
        if (!f) {
          alert("Pick a file first (.pdf, .docx, .txt, .md)");
          return;
        }
        const form = new FormData();
        form.append("file", f);

        const res = await fetch(`${API_BASE}/upload`, { method: "POST", body: form });
        const data = await res.json();
        alert(data.message || "Uploaded!");
      }

      async function ask() {
        const query = document.getElementById("q").value;
        const res = await fetch(`${API_BASE}/ask`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ query })
        });
        const data = await res.json();
        document.getElementById("a").innerText = data.answer || "(no answer)";
      }
    </script>
  </body>
</html>
